# 日志系统设计

## 什么是日志？

我们使用**日志**记录整个系统的运行情况。包含以下情况：

+ HTTP请求
+ SQL请求
+ 错误
+ 第三方接口
+ ...



## 目的

+ 方便调试，更快的帮我们定位问题



## 库

1. `tracing`

   + 一个有**范围**的、**结构化**的日志和诊断系统

   + 异步编程中使用传统的日志是存在一些问题的，因为异步任务执行起来没有确定的顺序，输出的时候没有确定的逻辑顺序。

   + `tracing`引入了`span`概念，一个span代表了从开始到结束的一个时间段，在此期间的信息都可以记录。

   + 5个日志级别

     + TRACE
     + DEBUG
     + INFO
     + WARN 
     + ERROR

     

   

2. `tracing-subscriber`
   + `tracing`本身不会记录日志，我们可以使用`tracing-subscriber`来收集`event!()`或者其他记录日志宏发出的日志。
   + 只需要在可执行程序中初始化`subscriber`，其他地方都可以直接使用日志相关宏来发出日志即可
3. `tracing_appender`
   1. 更改日志输出的一些默认设置
      1. 输出位置
      2. 颜色
      3. 日期
      4. 显示信息
      5. ...
   2. 使用`tracing_appender`时，要求必须在`main()`函数中使用`Guard`，否则`guard`被丢弃将不会写入任何信息到文件

